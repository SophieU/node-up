<!--统计查看-->

<!DOCTYPE html> 
<html>

<head>
    <meta charset="utf-8">
    <title>一生约-计费标准设置</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="../../css/base/base.css" />
    <link rel="stylesheet" type="text/css" href="../../css/moneyManage/moneyMange.css" />
</head>

<body>
<!--顶部菜单-->
<script src="../menu-top.js"></script>
<!--顶部菜单-->
<!--内容部分开始-->
<div id="main">
    <!--左边导航开始-->
    <div class="main-nav">
        <script src="../menu-left.js"></script>
    </div>
    <!--左边导航结束-->
    <div class="main-info">
        <!-- 主要内容开始 -->
        <div class="message-list main-content edit-standard">
            <h4 class="page-title">编辑计费标准</h4>
            <table class="table-form">
                <tr>
                    <td ><span class="must">选择小区</span> </td>
                    <td>
                        <select class="table-control">
                            <option value="">青秀城</option>
                            <option value="">南城都汇</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><span class="must">计费名称</span></td>
                    <td>
                        <input type="text"  class="table-control" value="25栋别墅物业费">
                    </td>
                </tr>
                <tr>
                    <td><span class="must">计费科目</span></td>
                    <td>
                        <select class="table-control">
                            <option value="">电梯住宅物管费</option>
                        </select>
                    </td>
                </tr>
                <tr>
                        <td><span class="must">公摊系数</span></td>
                        <td>
                            <input type="number"  class="table-control" value="1.0" step="0.1">
                        </td>
                    </tr>
                <tr>
                    <td><span class="must">是否收取滞纳金</span></td>
                    <td>
                        <select class="table-control" onchange="checkLateFee(this)">
                            <option value="0">不收取</option>
                            <option value="1">收取</option>
                        </select>
                        <div class="inline-input hide">
                            <span class="must">收取比率</span>
                            <input type="text" value="0.001">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td><span class="must">计费公式</span></td>
                    <td>
                        <select class="table-control">
                            <option value=""> <基本单价>*<房屋产权面积> </option>
                            <option value=""><基本单价> </option>
                        </select>
                        <button onclick="settingCalc()" class="layui-btn layui-btn-sm layui-btn-normal">新增计费公式</button>
                    </td>
                </tr>
                <tr>
                    <td>备注</td>
                    <td>
                        <div class="text-input">
                            <textarea name="" rows="4" maxlength="100"></textarea>
                            <span class="text-count">0/100</span>
                        </div>

                    </td>
                </tr>
                <tr>
                    <td>单价设置</td>
                    <td>
                        <div class="button-groups">
                            <button id="addPrice" class="layui-btn layui-btn-sm layui-btn-normal" ><i class="fa fa-plus"></i> 增加</button>
                            <button id="delPrice" class="layui-btn layui-btn-sm layui-btn-danger"><i class="fa fa-trash-o"></i> 删除</button>
                        </div>

                        <table class="table-input priceTable">
                            <thead>
                            <tr>
                                <th class="check-col"><input   type="checkbox"></th>
                                <th><span class="must">单价</span></th>
                                <th><span class="must">计量单位</span></th>
                                <th><span class="must">生效日期</span></th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td class="check-col"><input   type="checkbox"></td>
                                <td><input class="input-item" value=0.1 onkeyup="this.value=this.value.replace(/\D/,'')" type="text"></td>
                                <td><input class="input-item" type="text" value="元"></td>
                                <td><input class="input-item dateInput" value="2018-01-01" type="text"></td>
                            </tr>
                            </tbody>
                        </table>
                        <!--<div class="panel">-->
                           <!---->
                            <!--<div class="panel-body">-->
                               <!---->
                            <!--</div>-->
                        <!--</div>-->
                    </td>
                </tr>
            </table>
            <div class="main-footer clearfix">
                <div class="pull-right">
                    <button onclick="window.history.back();" class="layui-btn layui-btn-primary">返回</button>
                    <button class="layui-btn layui-btn-normal">保存设置</button>
                </div>

            </div>
        </div>


    </div>
    <!-- 左侧导航结束 -->
</div>
<!--内容部分结束-->

</body>
<script src="../../libs/jquery/jquery-2.1.0.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" src="../../libs/layui/layui.all.js"></script>
<script src="../../js/global.js" type="text/javascript" charset="utf-8"></script>
<!-- 操作 -->
<script type="text/javascript " charset="utf-8 ">
//单价时间
var laydate = layui.laydate;
laydate.render({
    elem:'.dateInput'
})
//增加单价
var layer = layui.layer;
$('#addPrice').on('click',function(){
    var html='<tr><td class="check-col"><input lay-skin="primary" type="checkbox"></td>'+
        '<td><input class="input-item" autofocus="autofocus" onkeyup="this.value=this.value.replace(/\D/,'+''+')"  type="number" /></td>'+
        '<td><input class="input-item" type="text"></td>'+
        '<td><input class="input-item dateInput" type="text"></td></tr>'
    $('.priceTable').append(html);
    //绑定时间选择
    var laydate = layui.laydate;
    lay('.dateInput').each(function(){
        laydate.render({
        elem: this
        ,trigger: 'click'
        });
    });
    //简单验证输入
    $('.priceTable').on('blur','.input-item',function(){
        if($(this).hasClass('dateInput')) return;
        var value= $(this).val();
        if(!value){
            layer.msg('填写内容不能为空',{
                time:2000,
            });
            $(this).focus();
        }
    });

})
$('#delPrice').on('click',function(){
    var tags = $('.priceTable').find('td input[type="checkbox"]');
    $(tags).each(function(index,item){
        if($(item).prop('checked')){
            $(this).closest('tr').remove()
        }
    })
})
    function checkLateFee(target){
        var val = target.value; //0 不收，1收取
        if(val==='1'){
            console.log( $(target).siblings('.inline-input'))
            $(target).siblings('.inline-input').removeClass('hide')
        }else{
            $(target).siblings('.inline-input').addClass('hide')
        }

        console.log(val)
    }
    function settingCalc(){
        var layer = layui.layer
        layer.open({
            type: 2,
            title: '计费公式设置',
            shadeClose: true, //不显示关闭按钮
            shade: false,
            area: ['800px', '630px'],
            anim: 2,
            maxmin: true, //开启最大化最小化按钮
            content: ['./calculator.html'], //iframe的url，no代表不显示滚动条

        });
    }

</script>

</html>