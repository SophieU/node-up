<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>应收查询-线下收费</title>
    <link rel="stylesheet" type="text/css" href="../../css/base/base.css" />
    <link rel="stylesheet" href="../../libs/zTree_v3/css/metroStyle/metroStyle.css">
    <link rel="stylesheet" href="../../css/moneyManage/moneyMange.css">
</head>
<body class="layuer-body">
<!--顶部菜单-->
<script src="../menu-top.js"></script>
<!--顶部菜单-->
<div id="main">
    <!--左边导航开始-->
    <div class="main-nav">
        <script src="../menu-left.js"></script>
    </div>
    <!--左边导航结束-->
    <div class="main-info return-fee">
        <!-- 目录导航开始 -->
        <div class="info-title">
            <div class="breadcrumb-nav">
                <span>首页</span>
                <span><i class="layui-icon layui-icon-right"></i></span>
                <span>应收查询</span>
                <span><i class="layui-icon layui-icon-right"></i></span>
                <span>线下收费</span>
            </div>
            <button class="layui-btn layui-btn-normal" onclick="window.history.back()">返回上一页</button>
        </div>
        <div id="return-fee">
            <div class="layui-row">
                <div class="layui-col-md3 left">
                    <div class="layui-card">
                        <div class="layui-card-header">业主信息</div>
                        <div class="layui-card-body">
                            <div id="userTree" class="ztree"> </div>
                        </div>
                    </div>

                </div>
                <div class="layui-col-md9">
                    <div class="layui-card">
                        <div class="layui-card-header">实收明细</div>
                        <div class="layui-card-body">
                            <div class="clearfix">
                                <div class="pull-right">
                                    <button  data-toggle="modal" data-target="#tearBill" class="layui-btn layui-btn-normal">拆单收费</button>
                                </div>
                            </div>
                            <table class="layui-table mini-table">
                                <thead>
                                <tr>
                                    <th><input type="checkbox"></th>
                                    <th>小区名称</th>
                                    <th>资源名称</th>
                                    <th>计费名称</th>
                                    <th>计费科目</th>
                                    <th>业主手机号</th>
                                    <th>业主姓名</th>
                                    <th>滞纳金</th>
                                    <th>应收金额</th>
                                    <th>应收时间</th>
                                    <th>收费员</th>
                                    <th>计费周期</th>
                                </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><input type="checkbox"></td>
                                        <td>基材</td>
                                        <td>1栋1单元101</td>
                                        <td>物业费</td>
                                        <td>物业费</td>
                                        <td>18112341234</td>
                                        <td>王大力</td>
                                        <td><span class="text-danger">-0.24</span></td>
                                        <td>202.12</td>
                                        <td>2018-03-26</td>
                                        <td>小苹果</td>
                                        <td>2018-03 至 2018-04</td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <td colspan="2">总计</td>
                                       <td colspan="10">404.24</td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="layui-card">
                <div class="layui-card-header">收费信息</div>
                <div class="layui-card-body">
                    <table class="table-form" >
                        <tr>
                            <td>支付方式</td>
                            <td class="grey-text">
                                <select name="" id="" class="table-control">
                                    <option value="">支付宝</option>
                                </select>
                            </td>
                            <td>收费员</td>
                            <td class="grey-text">王大力</td>
                            <td>收费日期</td>
                            <td class="grey-text"><input  readonly type="text" value="2018-04-08 " class="table-control dateTimeInput"></td>
                        </tr>
                        <tr>
                            <td>应收总额</td>
                            <td class="grey-text">202.12</td>
                            <td>拆单抵扣</td>
                            <td>0.00</td>
                            <td>
                                <span>折扣：</span>
                                <input type="number" class="table-control w100">
                            </td>
                            <td>
                                <span>折扣金额：</span>
                                <input type="text" class="table-control w100">
                            </td>
                        </tr>
                        <tr>
                            <td>滞纳金</td>
                            <td><input class="table-control w100" type="number" step="0.01" value="0.24"></td>
                            <td>实缴总额</td>
                            <td class="grey-text">200.12</td>
                            <td colspan="2">
                                <label>
                                    <input type="checkbox"  id="printBill">
                                    打印发票
                                </label>
                            </td>
                        </tr>
                        <tr>
                            <td>备注</td>
                            <td colspan="4">
                                <div class="text-input">
                                    <textarea ></textarea>
                                    <span class="text-count">0/50</span>
                                </div>
                            </td>
                            <td>
                                <button onclick="sureCharge()" class="layui-btn layui-btn-danger">确认退费</button>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade hide" id="tearBill">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4>拆单收费</h4>
            </div>
            <div class="modal-body">
                <div class="long-label">
                    <div class="layui-form-item">
                        <label for="" class="layui-form-label">当前欠费总额：</label>
                        <div class="layui-form-label" style="text-align: left">404.24</div>
                    </div>
                    <div class="layui-form-item">
                        <label for="" class="layui-form-label">拆分收费金额：</label>
                        <div class="layui-input-block" style="width: 200px;">
                            <input type="text" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label for="" class="layui-form-label">剩余欠费：</label>
                        <div class="layui-form-label" style="text-align: left">0.24</div>
                    </div>
                    <div class="layui-form-item layui-form-text">
                        <label class="layui-form-label">收费备注 <i class="must"></i>:</label>
                        <div class="layui-input-block">
                            <textarea name="desc" placeholder="请输入内容" class="layui-textarea"></textarea>
                        </div>
                    </div>

                </div>
            </div>
            <div class="modal-footer">
                <button class="layui-btn layui-btn-normal" onclick="sureTear()">确定</button>
                <button class="layui-btn layui-btn-primary" data-dismiss="modal">取消</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade hide" id="printModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4>打印发票</h4>
            </div>
            <div class="modal-body">
                <div class="long-label">
                    <div class="layui-form-item ">

                        <label class="layui-form-label" >请选择票据种类 <i class="must"></i>：</label>
                        <div class="layui-input-block">
                            <select name="" id="">
                                <option value="">111</option>
                                <option value="">222</option>
                            </select>
                        </div>

                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">请选择票据编号 <i class="must"></i>：</label>
                        <div class="layui-input-block">
                            <select  >
                                <option value="">111</option>
                                <option value="">222</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="layui-btn layui-btn-normal">确定</button>
                <button class="layui-btn layui-btn-primary" data-dismiss="modal">取消</button>
            </div>
        </div>
    </div>
</div>

<script src="../../libs/jquery/jquery-2.1.0.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" src="../../libs/layui/layui.all.js"></script>
<script src="../../libs/zTree_v3/js/jquery.ztree.all.min.js"></script>
<script src="../../js/global.js" type="text/javascript" charset="utf-8"></script>
<script>
    var setting = {
        treeId:'userTree',
    }
    var nodes=[
        {name:'1-1-103',
            open:true,
            children:[
                {name:'业主姓名：李世民'},
                {name:'手机号：18602871234'},
                {name:'房屋产权面积：101'},
                {name:'是否交房：是'},
                {name:'交房时间：2018-08-12'},
                {name:'是否出租：否'},
                {name:'是否装修：否'},
                {name:'是否空置：是'},
                {name:'是否出售：否'},
                {name:'车位状态1：购买'},
                {name:'车位类型1：1.8L'},
            ]
        }
    ]
    var zTreeObj=$.fn.zTree.init($('#userTree'),setting,nodes);
//拆单收费
    function sureTear(){
        var layer=layui.layer;
        var index = layer.confirm('此次拆单收费共抵扣费用合计400元整，请再次确认以上信息是否无误！？', {
            btn: ['确定','取消'] //按钮
        }, function(){
            layer.msg('确定收费', {icon: 1});
        }, function(){
            layer.close(index)
        });
    }

    //确认收费
    function sureCharge(){
        var layer=layui.layer;
        var index = layer.confirm('请确认是否已完成线下收款？', {
            btn: ['确定','取消'], //按钮
            icon:3
        }, function(){
            var print = $('#printBill').prop("checked");
            if(print){
                $('#printModal').removeClass('hide');
                layer.close(index);
                var printIndex = layer.open({
                    type:1,
                    shade:false,
                    title:false,
                    content:$("#printModal"),
                    area:['600px','auto'],
                    cancel:function(){
                        $('#printModal').addClass('hide');
                    }
                })
            }
            console.log(print)
            // layer.msg('打印发票了', {icon: 1});
        }, function(){
            layer.close(index)
        });
    }
</script>

</body>
</html>